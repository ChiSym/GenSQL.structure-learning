schema: '2.0'
stages:
  pre-process:
    cmd: "scripts/pre_process.py --states $(bin/param states) --subsample $(bin/param\
      \ sample_training_data)\n"
    deps:
    - path: data/raw/CES22_Common.csv
      md5: 1561d160a0178415feaba1687a022c51
      size: 154854944
    - path: scripts/pre_process.py
      md5: b69dca4664695a92d804d7ac019eec8d
      size: 13314
    params:
      params.yaml:
        sample_training_data: 20000
        states:
        - Alabama
        - Wyoming
        - Maine
        - New York
        - Texas
        - Michigan
        - Iowa
        - Idaho
        - Ohio
        - Mississippi
    outs:
    - path: data/data-orig.csv
      md5: d50579b39ccab9b965feac5e09f66e51
      size: 5363831
    - path: data/data.csv
      md5: e553b78f46c9d4ea6bfb1b8eda7873f3
      size: 13999626
    - path: data/test-orig.csv
      md5: a6042942155c1974beccfc66e0d02724
      size: 2824441
    - path: data/test.csv
      md5: 629dafd8298cb1054a5fd4742c9ec2be
      size: 7268190
  validate-column-names:
    cmd: bin/validate.sh
    deps:
    - path: data/data.csv
      md5: e553b78f46c9d4ea6bfb1b8eda7873f3
      size: 13999626
    outs:
    - path: data/validated.csv
      md5: e553b78f46c9d4ea6bfb1b8eda7873f3
      size: 13999626
  nullify:
    cmd: "clojure -X inferenceql.auto-modeling.main/nullify < data/validated.csv >\
      \ data/nullified.csv\n"
    deps:
    - path: data/validated.csv
      md5: e553b78f46c9d4ea6bfb1b8eda7873f3
      size: 13999626
    params:
      params.yaml:
        nullify:
    outs:
    - path: data/nullified.csv
      md5: f0dc0cd2c119c216808804399a77931f
      size: 13999626
  cgpm-schema:
    cmd: "clojure -X inferenceql.auto-modeling.main/cgpm-schema < schema.edn > data/cgpm-schema.edn\n"
    deps:
    - path: schema.edn
      md5: 926107a94af6de86d37f82dd9a78d2f7
      size: 3857
    outs:
    - path: data/cgpm-schema.edn
      md5: 207f7d2d45fb80db10230f901bba9f29
      size: 4248
  loom-schema:
    cmd: "clojure -X inferenceql.auto-modeling.main/loom-schema < schema.edn > data/loom-schema.json\n"
    deps:
    - path: schema.edn
      md5: 926107a94af6de86d37f82dd9a78d2f7
      size: 3857
    outs:
    - path: data/loom-schema.json
      md5: 81b83daf4a1337d513209cd74090c581
      size: 3386
  ignore:
    cmd: "clojure -X inferenceql.auto-modeling.main/ignore :schema '\"schema.edn\"\
      ' < data/data.csv > data/ignored.csv\n"
    deps:
    - path: data/nullified.csv
      md5: f0dc0cd2c119c216808804399a77931f
      size: 13999626
    - path: schema.edn
      md5: 926107a94af6de86d37f82dd9a78d2f7
      size: 3857
    outs:
    - path: data/ignored.csv
      md5: f15e255c7722f72b6eceaa873fc5c689
      size: 13697775
  numericalize:
    cmd: "clojure -X inferenceql.auto-modeling.main/numericalize :schema '\"schema.edn\"\
      ' :table data/mapping-table.edn < data/ignored.csv > data/numericalized.csv\n"
    deps:
    - path: data/ignored.csv
      md5: f15e255c7722f72b6eceaa873fc5c689
      size: 13697775
    - path: schema.edn
      md5: 926107a94af6de86d37f82dd9a78d2f7
      size: 3857
    outs:
    - path: data/mapping-table.edn
      md5: 96b068d3d89aebff060e39a278845b0c
      size: 7718
    - path: data/numericalized.csv
      md5: a2d20a52f8ec4797fbecf974996f92ec
      size: 3441460
  loom-ingest:
    cmd: ./bin/loom_task ingest loom data/loom-schema.json data/numericalized.csv
    deps:
    - path: data/loom-schema.json
      md5: 81b83daf4a1337d513209cd74090c581
      size: 3386
    - path: data/numericalized.csv
      md5: a2d20a52f8ec4797fbecf974996f92ec
      size: 3441460
    outs:
    - path: loom/ingest
      md5: cc58f0da4258e14ac1eee8afdaa51826.dir
      size: 1559986
      nfiles: 7
    - path: loom/query
      md5: bba044876548f9c304ee687da5e02725.dir
      size: 106
      nfiles: 1
  loom-infer-config:
    cmd: "clojure -X inferenceql.auto-modeling.main/infer-config < params.yaml > data/infer-config.json\n"
    params:
      params.yaml:
        loom.extra_passes: 50
        seed: 42
    outs:
    - path: data/infer-config.json
      md5: 10702555e9a00da2129bc02e87991235
      size: 42
  loom-infer:
    cmd: ./bin/loom_task infer loom $(bin/param sample_count) data/infer-config.json
    deps:
    - path: data/infer-config.json
      md5: 10702555e9a00da2129bc02e87991235
      size: 42
    - path: loom/ingest
      md5: cc58f0da4258e14ac1eee8afdaa51826.dir
      size: 1559986
      nfiles: 7
    - path: loom/query
      md5: bba044876548f9c304ee687da5e02725.dir
      size: 106
      nfiles: 1
    params:
      params.yaml:
        sample_count: 14
    outs:
    - path: loom/samples
      md5: 760b04652fef0a4b1d0b1171556f1f10.dir
      size: 16296098
      nfiles: 116
  loom-dump-metadata:
    cmd: "mkdir -p data/cgpm/raw && find loom/samples -mindepth 1 -maxdepth 1 -type\
      \ d | parallel $(bin/param parallel.flags) ./bin/loom python scripts/loom_dump.py\
      \ {} --output data/cgpm/raw/{/}.json\n"
    deps:
    - path: loom/samples
      md5: 760b04652fef0a4b1d0b1171556f1f10.dir
      size: 16296098
      nfiles: 116
    - path: scripts/loom_dump.py
      md5: c43616fe12258e9314fe1b481a6971e8
      size: 1978
    params:
      params.yaml:
        parallel.flags: --verbose
    outs:
    - path: data/cgpm/raw
      md5: 90640d063cf82ec2c254c58793ac06b3.dir
      size: 2155079
      nfiles: 14
  cgpm-hydrate-metadata:
    cmd: "find data/cgpm/raw -type f | parallel jsonschema --instance {} schemas/cgpm.json\
      \ && mkdir -p data/cgpm/hydrated && rm -f data/cgpm/inf.log && find data/cgpm/raw\
      \ -type f | sort | parallel $(bin/param parallel.flags) 'python scripts/cgpm_hydrate.py\
      \ --metadata {} --output data/cgpm/hydrated/{/} --data data/numericalized.csv\
      \ --schema data/cgpm-schema.edn --mapping-table data/mapping-table.edn --seed\
      \ $(($(bin/param seed) + {#} - 1))'\n"
    deps:
    - path: data/cgpm-schema.edn
      md5: 207f7d2d45fb80db10230f901bba9f29
      size: 4248
    - path: data/cgpm/raw
      md5: 90640d063cf82ec2c254c58793ac06b3.dir
      size: 2155079
      nfiles: 14
    - path: data/mapping-table.edn
      md5: 96b068d3d89aebff060e39a278845b0c
      size: 7718
    - path: data/numericalized.csv
      md5: a2d20a52f8ec4797fbecf974996f92ec
      size: 3441460
    - path: schemas/cgpm.json
      md5: 75fb21013e98a73e03fbe1ace14426f2
      size: 4039
    - path: scripts/cgpm_hydrate.py
      md5: f87e71b673e76ab54ae55e906830d3b2
      size: 2286
    params:
      params.yaml:
        parallel.flags: --verbose
        seed: 42
    outs:
    - path: data/cgpm/hydrated
      md5: f6e62aeb82c59cffca69a93a8c6bc632.dir
      size: 130054509
      nfiles: 14
  cgpm-infer-hyperparameters:
    cmd: "find data/cgpm/hydrated -type f | parallel jsonschema --instance {} schemas/cgpm.json\
      \ && mkdir -p data/cgpm/complete && echo $(bin/param cgpm.minutes) >> data/cgpm/inf.log\
      \ && find data/cgpm/hydrated -type f | sort | parallel $(bin/param parallel.flags)\
      \ 'python scripts/cgpm_infer.py {} --kernel alpha --kernel view_alphas --kernel\
      \ column_hypers --kernel rows --kernel columns --output data/cgpm/complete/{/}\
      \ --seed $(($(bin/param seed) + {#} - 1)) --iterations $(bin/param cgpm.iterations)'\
      \ #--minutes $(bin/param cgpm.minutes)'\n"
    deps:
    - path: data/cgpm/hydrated
      md5: f6e62aeb82c59cffca69a93a8c6bc632.dir
      size: 130054509
      nfiles: 14
    - path: schemas/cgpm.json
      md5: 75fb21013e98a73e03fbe1ace14426f2
      size: 4039
    - path: scripts/cgpm_infer.py
      md5: 51783e2f3278f3419876f9befde86461
      size: 2157
    params:
      params.yaml:
        cgpm.iterations: 10
        parallel.flags: --verbose
        seed: 42
    outs:
    - path: data/cgpm/complete
      md5: 55f4851717008ba0946f9a2702b038b0.dir
      size: 130307074
      nfiles: 14
  ast-export:
    cmd:
    - 'parallel --verbose jsonschema --instance {} schemas/cgpm.json :::: <(find data/cgpm/complete
      -type f)'
    - mkdir -p data/ast
    - "parallel --verbose 'python scripts/ast_export.py --metadata {} --data data/numericalized.csv\
      \ --mapping-table data/mapping-table.edn --output data/ast/{/.}.edn' :::: <(find\
      \ data/cgpm/complete -type f)"
    deps:
    - path: data/cgpm/complete
      md5: 55f4851717008ba0946f9a2702b038b0.dir
      size: 130307074
      nfiles: 14
    - path: data/ignored.csv
      md5: f15e255c7722f72b6eceaa873fc5c689
      size: 13697775
    - path: scripts/ast_export.py
      md5: 573cc404efd53361edc764e5c517ee8e
      size: 11046
    params:
      params.yaml:
        parallel.flags: --verbose
    outs:
    - path: data/ast
      md5: 315d86a49e094cc649712cf9ea41d259.dir
      size: 35638149
      nfiles: 14
  save-dependencies:
    cmd: "find data/cgpm/complete -type f | sort | xargs python scripts/dep_prob.py\
      \ --data data/numericalized.csv --output data/dep-prob.json\n"
    deps:
    - path: data/cgpm/complete
      md5: 55f4851717008ba0946f9a2702b038b0.dir
      size: 130307074
      nfiles: 14
    outs:
    - path: data/dep-prob.json
      md5: ca644b35a46890d4c7ade30a45e101b6
      size: 375525
  sppl-import:
    cmd:
    - mkdir -p data/sppl/unmerged
    - "parallel --verbose 'python scripts/sppl_import.py --multi-mix-ast {} --max-number-views\
      \ data/max-number-views.txt --output data/sppl/unmerged/{/.}.json' :::: <(find\
      \ data/ast -type f)"
    deps:
    - path: data/ast
      md5: 315d86a49e094cc649712cf9ea41d259.dir
      size: 35638149
      nfiles: 14
    - path: data/max-number-views.txt
      md5: e4da3b7fbbce2345d7772b0674a318d5
      size: 1
    - path: scripts/sppl_import.py
      md5: 60da181980209f224dd1ed4f8b92c57e
      size: 4743
    params:
      params.yaml:
        parallel.flags: --verbose
    outs:
    - path: data/sppl/unmerged
      md5: 2af5b65de5186c0c282ade1f750dd762.dir
      size: 20719026
      nfiles: 14
  sppl-merge:
    cmd: "find data/sppl/unmerged -type f | sort | xargs python scripts/sppl_merge.py\
      \ --output data/sppl/merged.json\n"
    deps:
    - path: data/sppl/unmerged
      md5: 2af5b65de5186c0c282ade1f750dd762.dir
      size: 20719026
      nfiles: 14
    outs:
    - path: data/sppl/merged.json
      md5: 2664c520170316cc28f1782bdc998b6f
      size: 20720546
  sppl-sample:
    cmd: "python scripts/sppl_sample.py --model data/sppl/merged.json --data data/ignored.csv\
      \ --sample_count $(bin/param qc.sample_count) > qc/samples/samples-synthetic.edn\n"
    deps:
    - path: data/ignored.csv
      md5: f15e255c7722f72b6eceaa873fc5c689
      size: 13697775
    - path: data/sppl/merged.json
      md5: 2664c520170316cc28f1782bdc998b6f
      size: 20720546
    outs:
    - path: qc/samples/samples-synthetic.edn
      md5: 3634454e51fc54d8c991f86d9e618a16
      size: 76245389
  copy-result:
    cmd: "mkdir -p results/ran-$(date +%F_%H:%M) && cp data/sppl/merged.json results/ran-$(date\
      \ +%F_%H:%M)/merged.json && cp -r data/cgpm/ results/ran-$(date +%F_%H:%M)/cgpm\
      \ && cp -r data/ast/ results/ran-$(date +%F_%H:%M)/ast && cp schema.edn results/ran-$(date\
      \ +%F_%H:%M)/schema.edn && cp data/dep-prob.json results/ran-$(date +%F_%H:%M)/dep-prob.json\
      \ && cp data/linear-stats.json results/ran-$(date +%F_%H:%M)/linear-stats.json\
      \ && cp data/qc-statistical-tests.txt results/ran-$(date +%F_%H:%M)/qc-statistical-tests.txt\n"
    deps:
    - path: data/ast
      md5: 315d86a49e094cc649712cf9ea41d259.dir
      size: 35638149
      nfiles: 14
    - path: data/cgpm
      md5: c64eeb2527d462fb6701e5baec7d39cf.dir
      size: 262516688
      nfiles: 44
    - path: data/dep-prob.json
      md5: ca644b35a46890d4c7ade30a45e101b6
      size: 375525
    - path: data/linear-stats.json
      md5: 31b68f14624f833af663cdeeec8722c8
      size: 797787
    - path: data/qc-statistical-tests.txt
      md5: 2d2c21815b5a8ccb40729fe38a7468d3
      size: 29164
    - path: data/sppl/merged.json
      md5: 2664c520170316cc28f1782bdc998b6f
      size: 20720546
    - path: schema.edn
      md5: 926107a94af6de86d37f82dd9a78d2f7
      size: 3857
  save-linear-stats:
    cmd: "python scripts/linear_stats.py --data data/ignored.csv --schema data/schema.edn\
      \ --output data/linear-stats.json\n"
    deps:
    - path: data/ignored.csv
      md5: f15e255c7722f72b6eceaa873fc5c689
      size: 13697775
    - path: data/schema.edn
      md5: 926107a94af6de86d37f82dd9a78d2f7
      size: 3857
    - path: scripts/linear_stats.py
      md5: 10a3ac3a494c1cb9d8ffddb02e12b61b
      size: 3998
    outs:
    - path: data/linear-stats.json
      md5: 31b68f14624f833af663cdeeec8722c8
      size: 797787
  compare-dep-prob-with-linear:
    cmd: "python scripts/compare_deps.py --deps data/dep-prob.json --linear data/linear-stats.json\
      \ >> data/qc-statistical-tests.txt\n"
    deps:
    - path: data/dep-prob.json
      md5: ca644b35a46890d4c7ade30a45e101b6
      size: 375525
    - path: data/linear-stats.json
      md5: 31b68f14624f833af663cdeeec8722c8
      size: 797787
    outs:
    - path: data/qc-statistical-tests.txt
      md5: 2d2c21815b5a8ccb40729fe38a7468d3
      size: 29164
  xcat-complete-import:
    cmd:
    - mkdir -p data/xcat/complete/
    - "parallel --verbose 'clojure -X inferenceql.auto-modeling.xcat/import :cgpm-json\
      \ {} :data-csv data/ignored.csv :mapping-table data/mapping-table.edn :numericalized-csv\
      \ data/numericalized.csv :schema-edn schema.edn > data/xcat/complete/{/.}.edn'\
      \ :::: <(find data/cgpm/complete -type f)"
    deps:
    - path: data/cgpm/complete
      md5: 55f4851717008ba0946f9a2702b038b0.dir
      size: 130307074
      nfiles: 14
    - path: data/ignored.csv
      md5: f15e255c7722f72b6eceaa873fc5c689
      size: 13697775
    - path: data/mapping-table.edn
      md5: 96b068d3d89aebff060e39a278845b0c
      size: 7718
    - path: data/numericalized.csv
      md5: a2d20a52f8ec4797fbecf974996f92ec
      size: 3441460
    - path: schema.edn
      md5: 926107a94af6de86d37f82dd9a78d2f7
      size: 3857
    - path: src/inferenceql/auto_modeling/xcat.clj
      md5: dc5d691d8f3cd744340cb3c2168a7050
      size: 4629
    params:
      params.yaml:
        parallel.flags: --verbose
    outs:
    - path: data/xcat/complete/
      md5: 58be9f26141ad45b8d1095a0e20d4f73.dir
      size: 1456909025
      nfiles: 14
  qc-tag-samples:
    cmd: "clojure -X inferenceql.auto-modeling.qc.samples/tag :data data/ignored.csv\
      \ :schema schema.edn :samples-synthetic qc/samples/samples-synthetic.edn > qc/samples/samples.edn\n"
    deps:
    - path: data/ignored.csv
      md5: f15e255c7722f72b6eceaa873fc5c689
      size: 13697775
    - path: qc/samples/samples-synthetic.edn
      md5: 3634454e51fc54d8c991f86d9e618a16
      size: 76245389
    - path: schema.edn
      md5: 926107a94af6de86d37f82dd9a78d2f7
      size: 3857
    - path: src/inferenceql/auto_modeling/qc/samples.clj
      md5: 83ed8f3536aaaa4570d1a568b9055015
      size: 1113
    outs:
    - path: qc/samples/samples.edn
      md5: 60e79ed6bfbcfe533460526348cc76fb
      size: 160752512
  qc-dashboard-spec:
    cmd: "clojure -X inferenceql.auto-modeling.qc.dashboard/spec :samples qc/samples/samples.edn\
      \ :schema schema.edn :correlation data/linear-stats.json > qc/specs/qc-dashboard.vl.json\n"
    deps:
    - path: data/linear-stats.json
      md5: 31b68f14624f833af663cdeeec8722c8
      size: 797787
    - path: qc/samples/samples.edn
      md5: 60e79ed6bfbcfe533460526348cc76fb
      size: 160752512
    - path: schema.edn
      md5: 926107a94af6de86d37f82dd9a78d2f7
      size: 3857
    - path: src/inferenceql/auto_modeling/qc/dashboard.clj
      md5: ceae831bc1ad605ca51069128772ed31
      size: 24673
    - path: src/inferenceql/auto_modeling/qc/util.clj
      md5: 3f010451e4a984ba25520fd9c3b36654
      size: 3975
    params:
      params.yaml:
        qc.columns:
        - US_citizen
        - registered_to_vote
        - age
        - where_was_ballot_returned
        - divorced_last_year
        - policy_support_repealing_ACA
    outs:
    - path: qc/specs/qc-dashboard.vl.json
      md5: 00ad187e3e46225c10babf1a3707710c
      size: 172170252
  qc-dashboard-app:
    cmd: "clojure -X inferenceql.auto-modeling.qc.app/create :template qc/templates/index.html\
      \ :spec qc/specs/qc-dashboard.vl.json :renderer canvas :title '\"QC dashboard\"\
      ' > qc/app/qc-dashboard.html\n"
    deps:
    - path: qc/specs/qc-dashboard.vl.json
      md5: 00ad187e3e46225c10babf1a3707710c
      size: 172170252
    - path: qc/templates/index.html
      md5: ac51efb107febc1caf14b5e2c6d0489d
      size: 1685
    - path: src/inferenceql/auto_modeling/qc/app.clj
      md5: 9d4c0718ef4e415b3a8a82bf707296eb
      size: 519
    outs:
    - path: qc/app/qc-dashboard.html
      md5: 6fae0f514624b95c2a900b778fbaff8f
      size: 172171922
  cgpm-infer-subs:
    cmd: "find data/cgpm/raw -type f | parallel jsonschema --instance {} schemas/cgpm.json\
      \ && mkdir -p data/cgpm/hydrated && rm -f data/cgpm/inf.log && find data/cgpm/raw\
      \ -type f | sort | parallel $(bin/param parallel.flags) 'python scripts/cgpm_infer_subs.py\
      \ --metadata {} --output data/cgpm/hydrated/{/} --data data/numericalized.csv\
      \ --schema data/cgpm-schema.edn --mapping-table data/mapping-table.edn --kernel\
      \ alpha --kernel view_alphas --kernel column_hypers --kernel rows --kernel columns\
      \ --iterations $(bin/param cgpm.iterations) --seed $(($(bin/param seed) + {#}\
      \ - 1))'\n"
    deps:
    - path: data/cgpm-schema.edn
      md5: cc98cb85a879e36c8dc8a72caf2c1132
      size: 4271
    - path: data/cgpm/raw
      md5: bf80abcfec9df11b87e25d49bf1cef1a.dir
      size: 29131
      nfiles: 2
    - path: data/mapping-table.edn
      md5: 25c6c1014caa0ed9377ad53d8d1fa0f7
      size: 8419
    - path: data/numericalized.csv
      md5: 894970e73c4351e35361e2253b63c997
      size: 177299
    - path: schemas/cgpm.json
      md5: 75fb21013e98a73e03fbe1ace14426f2
      size: 4039
    - path: scripts/cgpm_hydrate.py
      md5: f87e71b673e76ab54ae55e906830d3b2
      size: 2286
    params:
      params.yaml:
        parallel.flags: --verbose
        seed: 42
    outs:
    - path: data/cgpm/hydrated
      md5: c60b58f6e4e6a9b4948c40ec22169905.dir
      size: 1133474
      nfiles: 2
  dep-prob-vl:
    cmd: "clojure -X inferenceql.auto-modeling.heatmap/vega-lite :stats-path '\"data/dep-prob.json\"\
      ' :domain '[0.0 1.0]' :default 1.0 :name '\"crosscat\"' :scheme '\"blues\"'\
      \ > data/dep-prob.vl.json\n"
    deps:
    - path: data/dep-prob.json
      md5: ca644b35a46890d4c7ade30a45e101b6
      size: 375525
    - path: src/inferenceql/auto_modeling/heatmap.clj
      md5: 6413cddd3b16a428a008cc88375fac36
      size: 7369
    outs:
    - path: data/dep-prob.vl.json
      md5: c245f194fbdd256fce34decd3ed8622f
      size: 827775
  dep-prob-vg:
    cmd: "pnpm vl2vg < data/dep-prob.vl.json > data/dep-prob.vg.json\n"
    deps:
    - path: data/dep-prob.vl.json
      md5: c245f194fbdd256fce34decd3ed8622f
      size: 827775
    outs:
    - path: data/dep-prob.vg.json
      md5: 2ba4178b6af45e857d44e437caf4e956
      size: 829048
  dep-prob-svg:
    cmd: "pnpm vg2svg < data/dep-prob.vg.json > data/dep-prob.svg\n"
    deps:
    - path: data/dep-prob.vg.json
      md5: 2ba4178b6af45e857d44e437caf4e956
      size: 829048
    outs:
    - path: data/dep-prob.svg
      md5: 783c9a85852488dbab7518e4e9e79e38
      size: 1744644
  save-max-number-views:
    cmd: "find data/cgpm/complete -type f | xargs python scripts/save_n_views.py >>\
      \ data/max-number-views.txt\n"
    deps:
    - path: data/cgpm/complete
      md5: 55f4851717008ba0946f9a2702b038b0.dir
      size: 130307074
      nfiles: 14
    outs:
    - path: data/max-number-views.txt
      md5: e4da3b7fbbce2345d7772b0674a318d5
      size: 1
  linear-stats-vl:
    cmd: "clojure -X inferenceql.auto-modeling.heatmap/vega-lite :stats-path '\"data/linear-stats.json\"\
      ' :sort-path '\"data/dep-prob.json\"' :domain '[1.0 0.0]' :default 0.0 :name\
      \ '\"statistics\"' :field '\"p-value\"' :scheme '\"oranges\"' > data/linear-stats.vl.json\n"
    deps:
    - path: data/dep-prob.json
      md5: ca644b35a46890d4c7ade30a45e101b6
      size: 375525
    - path: data/linear-stats.json
      md5: 31b68f14624f833af663cdeeec8722c8
      size: 797787
    - path: src/inferenceql/auto_modeling/heatmap.clj
      md5: 6413cddd3b16a428a008cc88375fac36
      size: 7369
    outs:
    - path: data/linear-stats.vl.json
      md5: 2dc974311f557ab352dc086f69cd28a2
      size: 887933
  linear-stats-vg:
    cmd: "pnpm vl2vg < data/linear-stats.vl.json > data/linear-stats.vg.json\n"
    deps:
    - path: data/linear-stats.vl.json
      md5: 2dc974311f557ab352dc086f69cd28a2
      size: 887933
    outs:
    - path: data/linear-stats.vg.json
      md5: ebf273c245f73851304b9a218d3f88c3
      size: 894213
  linear-stats-svg:
    cmd: "pnpm vg2svg < data/linear-stats.vg.json > data/linear-stats.svg\n"
    deps:
    - path: data/linear-stats.vg.json
      md5: ebf273c245f73851304b9a218d3f88c3
      size: 894213
    outs:
    - path: data/linear-stats.svg
      md5: fffe46969d229abb76e9e1599e571b91
      size: 1787498
  sppl-predict:
    cmd: "python scripts/poststrat.py --model data/sppl/merged.json --test data/test.csv\
      \ --targets $(bin/param targets) --output data/predictions.csv --reweight $(bin/param\
      \ reweight_on)\n"
    deps:
    - path: data/sppl/merged.json
      md5: 2664c520170316cc28f1782bdc998b6f
      size: 20720546
    - path: data/test.csv
      md5: 629dafd8298cb1054a5fd4742c9ec2be
      size: 7268190
    params:
      params.yaml:
        reweight_on:
        - age
        - gender
        - education
        - race
        - religion
        - union_member
        - device_used
        - party_allegiance
        - used_social_media_in_past_24hrs
        - watched_tv_news_in_past_24hrs
        - read_newspaper_in_past_24hrs
        - listened_to_radio_news_in_past_24hrs
        - national_econony_has
        - my_house_income_has
        - prices_have
        targets:
        - policy_support_expanding_medicare
        - policy_support_repealing_ACA
        - policy_support_ban_assault_rifles
    outs:
    - path: data/predictions.csv
      md5: 99e04dcb2aa6c2cef516c87dbf26e9b2
      size: 605682
  save-synth:
    cmd: "python scripts/save_synth.py --model data/sppl/merged.json --output data/synthetic-iql.csv\
      \ --data data/ignored.csv\n"
    deps:
    - path: data/ignored.csv
      md5: f15e255c7722f72b6eceaa873fc5c689
      size: 13697775
    - path: data/sppl/merged.json
      md5: 2664c520170316cc28f1782bdc998b6f
      size: 20720546
    - path: scripts/save_synth.py
      md5: 20b3188ba835caf3a9fd0c89ea9664d8
      size: 1370
    outs:
    - path: data/synthetic-iql.csv
      md5: 93fce16af0badb24c34e2a9bff543c54
      size: 15610359
  glm-predict:
    cmd: "python scripts/predict_glm.py\n"
    deps:
    - path: data/data-orig.csv
      md5: d50579b39ccab9b965feac5e09f66e51
      size: 5363831
    - path: data/test-orig.csv
      md5: a6042942155c1974beccfc66e0d02724
      size: 2824441
    params:
      params.yaml:
        reweight_on:
        - age
        - gender
        - education
        - race
        - religion
        - union_member
        - device_used
        - party_allegiance
        - used_social_media_in_past_24hrs
        - watched_tv_news_in_past_24hrs
        - read_newspaper_in_past_24hrs
        - listened_to_radio_news_in_past_24hrs
        - national_econony_has
        - my_house_income_has
        - prices_have
        targets:
        - policy_support_expanding_medicare
        - policy_support_repealing_ACA
        - policy_support_ban_assault_rifles
    outs:
    - path: data/predictions-glm.csv
      md5: b5afca1eda29b280928035804703901c
      size: 605513
