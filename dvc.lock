schema: '2.0'
stages:
  train-baseline@tvae:
    cmd: "poetry run train-baseline --data data/preprocessed.csv --column_models data/column_models.json
      --model tvae\n"
    deps:
    - path: data/column_models.json
      hash: md5
      md5: 0de858868b5a52df93dfb9068b89767f
      size: 5173
    - path: data/preprocessed.csv
      hash: md5
      md5: 89e944af8bc6e62d966fc9d13cf993ef
      size: 149879237
    outs:
    - path: data/tvae.pkl
      hash: md5
      md5: e2c84e7b761953aa295c33fa4d8719fe
      size: 504127
  sample-baseline@tvae:
    cmd: "poetry run sample-baseline --model tvae --sample_count 10000\n"
    deps:
    - path: data/tvae.pkl
      hash: md5
      md5: e2c84e7b761953aa295c33fa4d8719fe
      size: 504127
    outs:
    - path: data/synthetic-data-tvae.csv
      hash: md5
      md5: 9da3076af392499613d5c238aedaeb9e
      size: 2544083
  marginal-fits@tvae:
    cmd: "poetry run marginal_fits --real_data data/preprocessed.csv --model tvae
      --column_models data/column_models.json\n"
    deps:
    - path: data/preprocessed.csv
      hash: md5
      md5: 89e944af8bc6e62d966fc9d13cf993ef
      size: 149879237
    - path: data/synthetic-data-tvae.csv
      hash: md5
      md5: 9da3076af392499613d5c238aedaeb9e
      size: 2544083
    outs:
    - path: qc/marginals/tvae_1d_fits.csv
      hash: md5
      md5: 0b22e8b3a50ba1d73c96d3c6ab88d780
      size: 1109
    - path: qc/marginals/tvae_2d_fits.csv
      hash: md5
      md5: d52fd2a2f97068820de9cec4981c7882
      size: 19775
    - path: qc/marginals/tvae_worst_1d_fit.html
      hash: md5
      md5: 3974439fc1b0043b7c82d509f097c418
      size: 11820018
    - path: qc/marginals/tvae_worst_1d_fit.png
      hash: md5
      md5: 54fc030c648a6ac3629c14cafd0fbfbd
      size: 167750
    - path: qc/marginals/tvae_worst_2d_fit.html
      hash: md5
      md5: 6c6d5eabba7c9e732cb2309a5d85b323
      size: 14957073
    - path: qc/marginals/tvae_worst_2d_fit.png
      hash: md5
      md5: 1d8d1c5f815f853eacb0723025b468e3
      size: 112065
  marginal-fits-plot:
    cmd: "poetry run marginal-fits-plot -m cgpm-raw -m ctgan -m tvae\n"
    deps:
    - path: qc/marginals/cgpm-raw_1d_fits.csv
      hash: md5
      md5: 37b8346c19dcd1bf77ab31d262aebe6c
      size: 1114
    - path: qc/marginals/cgpm-raw_2d_fits.csv
      hash: md5
      md5: a0f7de401b32d2e784d0113be7227110
      size: 19739
    - path: qc/marginals/ctgan_1d_fits.csv
      hash: md5
      md5: 8a79fa745ff34d936a67e51fe4dddb21
      size: 1114
    - path: qc/marginals/ctgan_2d_fits.csv
      hash: md5
      md5: 91172324ee40a6373e071de0fe4f3ce3
      size: 19745
    outs:
    - path: qc/marginals/1d_fits.csv
      hash: md5
      md5: 00b0c3bd8b6fe2847fff01c4ccd5612c
      size: 3030
    - path: qc/marginals/2d_fits.csv
      hash: md5
      md5: 85022a6d9c0dc81e0f729fea35662e6b
      size: 47713
  train-baseline@ctgan:
    cmd: "poetry run train-baseline --data data/preprocessed.csv --column_models data/column_models.json
      --model ctgan\n"
    deps:
    - path: data/column_models.json
      hash: md5
      md5: 0de858868b5a52df93dfb9068b89767f
      size: 5173
    - path: data/preprocessed.csv
      hash: md5
      md5: 89e944af8bc6e62d966fc9d13cf993ef
      size: 149879237
    outs:
    - path: data/ctgan.pkl
      hash: md5
      md5: cacb942941e07998ad1e3ba78687de2f
      size: 945222788
  loom-to-cgpm:
    cmd: "mkdir -p data/cgpm/hydrated && ls loom/samples | parallel  \"poetry run
      loom_to_cgpm --column_model_filename data/column_models.json --data_filename
      data/preprocessed.csv --loom_folder loom/samples/{} --out_filename data/cgpm/hydrated/{}.json\"\
      \n"
    deps:
    - path: data/column_models.json
      hash: md5
      md5: 0de858868b5a52df93dfb9068b89767f
      size: 5173
    - path: data/preprocessed.csv
      hash: md5
      md5: 89e944af8bc6e62d966fc9d13cf993ef
      size: 149879237
    - path: loom/samples
      hash: md5
      md5: a6e9ab5a8bcb1b9abf6cce678fe49764.dir
      size: 2092688137
      nfiles: 150
    outs:
    - path: data/cgpm/hydrated
      hash: md5
      md5: c9f68bced1021424d7faa9da8f81cf9b.dir
      size: 269840046
      nfiles: 10
  dependence-probability@hydrated:
    cmd: poetry run dependence-probability --model_dir data/cgpm/hydrated --out_file
      qc/cgpm-hydrated-dependence-probability.csv
    deps:
    - path: data/cgpm/hydrated
      hash: md5
      md5: c9f68bced1021424d7faa9da8f81cf9b.dir
      size: 269840046
      nfiles: 10
    outs:
    - path: qc/cgpm-hydrated-dependence-probability.csv
      hash: md5
      md5: 0340d98ef5c565562c5da22c6f9cf181
      size: 18711
